<!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="utf-8">
  <title>BM Group 360 Tour</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pannellum@2.5.6/build/pannellum.css"/>
  <style>
    #panorama {
      width: 100vw;
      height: 100vh;
    }

    .custom-link-button {
      background-color: #ffffff;
      color: #005bbb;
      border: 1px solid #005bbb;
      border-radius: 6px;
      font-size: 13px;
      padding: 6px 10px;
      font-family: "Segoe UI", sans-serif;
      display: inline-block;
      cursor: pointer;
      opacity: 0;
      animation: fadeInButton 0.5s ease-in forwards 2.5s;
      transition: all 0.3s ease;
      margin-top: 8px;
    }

    .custom-link-button:hover {
      background-color: #005bbb;
      color: white;
      transform: scale(1.05);
    }

    @keyframes fadeInButton {
      to { opacity: 1; }
    }
  </style>
</head>
<body>

<div id="panorama"></div>

<script src="https://cdn.jsdelivr.net/npm/pannellum@2.5.6/build/pannellum.js"></script>
<script>
  // üîπ 1. Matnlarni ikki tilda saqlaymiz
  const texts = {
    uz: [
      "Sergeli tumani, Yangi Shoshtepa Jun ariq ko‚Äôchasida 12-16 qavatli binolardan tashkil topgan zamonaviy yangi shaharcha. Bu yerda farovon yashash uchun barcha sharoitlar yaratilgan: maktab, bog‚Äòcha, do‚Äòkonlar va transport qulayligi.",
      "Go‚Äôzal poytaxtimizning tarixiy Shayxontoxur tumani, Samarqand Darvoza ko‚Äôchasida qurilayotgan turar-joy majmuamiz. U fransuz uslubidagi fasadga, yashil hududga va rivojlangan infratuzilmaga ega bo‚Äòlib, yuqori sifatli hayot tarzini taklif etadi.",
      "Chilonzor tumani, Tersakabad ko‚Äôchasida 16 qavatli binolardan tashkil topgan zamonaviy yangi shaharcha barpo etilmoqda. Loyiha doirasida ko‚Äòplab savdo nuqtalari, bolalar maydonchasi, sport zonasi va keng avtoturargoh mavjud."
    ],
    ru: [
      "–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –Ω–æ–≤—ã–π –≥–æ—Ä–æ–¥–æ–∫ –≤ –°–µ—Ä–≥–µ–ª–∏, –Ω–∞ —É–ª–∏—Ü–µ –Ø–Ω–≥–∏ –®–æ—à—Ç–µ–ø–∞ –î–∂—É–Ω –∞—Ä–∏“õ, —Å–æ—Å—Ç–æ—è—â–∏–π –∏–∑ 12-16 —ç—Ç–∞–∂–Ω—ã—Ö –∑–¥–∞–Ω–∏–π. –ó–¥–µ—Å—å —Å–æ–∑–¥–∞–Ω—ã –≤—Å–µ —É—Å–ª–æ–≤–∏—è –¥–ª—è –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ–π –∂–∏–∑–Ω–∏: —à–∫–æ–ª–∞, –¥–µ—Ç—Å–∫–∏–π —Å–∞–¥, –º–∞–≥–∞–∑–∏–Ω—ã –∏ —É–¥–æ–±–Ω—ã–π —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç.",
      "–ù–∞—à –∂–∏–ª–æ–π –∫–æ–º–ø–ª–µ–∫—Å –≤ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–º –®–∞–π—Ö–æ–Ω—Ç–æ—Ö—É—Ä—Å–∫–æ–º —Ä–∞–π–æ–Ω–µ –Ω–∞ —É–ª–∏—Ü–µ –°–∞–º–∞—Ä–∫–∞–Ω–¥ –î–∞—Ä–≤–æ–∑–∞. –û–Ω –∏–º–µ–µ—Ç —Ñ–∞—Å–∞–¥ –≤ —Ñ—Ä–∞–Ω—Ü—É–∑—Å–∫–æ–º —Å—Ç–∏–ª–µ, –∑–µ–ª–µ–Ω—É—é —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏—é –∏ —Ä–∞–∑–≤–∏—Ç—É—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É, –ø—Ä–µ–¥–ª–∞–≥–∞—è –≤—ã—Å–æ–∫–∏–π —É—Ä–æ–≤–µ–Ω—å –∂–∏–∑–Ω–∏.",
      "–í –ß–∏–ª–∞–Ω–∑–∞—Ä—Å–∫–æ–º —Ä–∞–π–æ–Ω–µ, –Ω–∞ —É–ª–∏—Ü–µ –¢–µ—Ä—Å–∞–∫–æ–±–æ–¥, –≤–æ–∑–≤–æ–¥–∏—Ç—Å—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –Ω–æ–≤—ã–π –≥–æ—Ä–æ–¥–æ–∫ –∏–∑ 16-—ç—Ç–∞–∂–Ω—ã—Ö –∑–¥–∞–Ω–∏–π. –í –ø—Ä–æ–µ–∫—Ç–µ –ø—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ–Ω—ã —Ç–æ—Ä–≥–æ–≤—ã–µ —Ç–æ—á–∫–∏, –¥–µ—Ç—Å–∫–∞—è –ø–ª–æ—â–∞–¥–∫–∞, —Å–ø–æ—Ä—Ç–∏–≤–Ω–∞—è –∑–æ–Ω–∞ –∏ –ø—Ä–æ—Å—Ç–æ—Ä–Ω–∞—è –ø–∞—Ä–∫–æ–≤–∫–∞."
    ]
  };

  // üîπ 2. Navbar‚Äôda tanlangan tilni localStorage‚Äôdan olish
  const lang = localStorage.getItem("lang") || "uz";

  // üîπ 3. Hotspot matn bloki yaratish funksiyasi
  function createTextBlock(hotSpotDiv, fullText) {
    const wrapper = document.createElement("div");
    wrapper.style.background = "#005bbb";
    wrapper.style.color = "#fff";
    wrapper.style.padding = "12px 16px";
    wrapper.style.borderRadius = "12px";
    wrapper.style.fontSize = "12px";
    wrapper.style.lineHeight = "1.6";
    wrapper.style.fontFamily = "Segoe UI, sans-serif";
    wrapper.style.textAlign = "left";
    wrapper.style.boxShadow = "0 4px 12px rgba(0,0,0,0.1)";
    wrapper.style.minWidth = "380px";
    wrapper.style.maxWidth = "300px";

    const message = document.createElement("div");
    wrapper.appendChild(message);

    const button = document.createElement("div");
    button.innerText = lang === "uz" ? "Yana..." : "–ï—â—ë...";
    button.className = "custom-link-button";
    wrapper.appendChild(button);

    hotSpotDiv.appendChild(wrapper);

    let i = 0;
    let isExpanded = false;
    let previewLength = 100;

    function typeWriter(limit) {
      if (i < limit) {
        message.innerHTML += fullText.charAt(i);
        i++;
        setTimeout(() => typeWriter(limit), 30);
      }
    }

    typeWriter(previewLength);

    button.onclick = function () {
      if (!isExpanded) {
        isExpanded = true;
        button.style.display = "none";
        typeWriter(fullText.length);
      }
    };
  }

  // üîπ 4. Pannellum viewer sozlamalari
  pannellum.viewer('panorama', {
    "type": "equirectangular",
    "panorama": "panorama.jpg",
    "autoLoad": true,
    "showZoomCtrl": false,
    "showFullscreenCtrl": false,
    "showControls": false,
    "hotSpots": [
      {
        "pitch": 10,
        "yaw": 190,
        "type": "custom",
        createTooltipFunc: function(hotSpotDiv) {
          createTextBlock(hotSpotDiv, texts[lang][0]);
        }
      },
      {
        "pitch": 10,
        "yaw": 140,
        "type": "custom",
        createTooltipFunc: function(hotSpotDiv) {
          createTextBlock(hotSpotDiv, texts[lang][1]);
        }
      },
      {
        "pitch": 5,
        "yaw": -10,
        "type": "custom",
        createTooltipFunc: function(hotSpotDiv) {
          createTextBlock(hotSpotDiv, texts[lang][2]);
        }
      }
    ]
  });
</script>

</body>
</html>
